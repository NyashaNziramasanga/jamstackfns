---
title: 'Stripe'
description: 'Accept a payment using Stripe’s Checkout flow.'
logo: 'stripe.png'
---

import Step from '../../components/Step';
import ToggleSwitch from '../../components/ToggleSwitch';

<ToggleSwitch />

```js
const stripe = require('stripe')(process.env.STRIPE_API_KEY);

export default async (req, res) => {
  const session = await stripe.checkout.sessions.create({
    payment_method_types: ['card'],
    line_items: [
      {
        name: 'Serverless Functions – The Complete Guide',
        description: '100 page e-book on serverless functions.',
        images: ['https://site.com/image.png'],
        amount: '5000', // Cents
        currency: 'usd',
        quantity: 1
      }
    ],
    success_url: 'https://site.com/success?session_id={CHECKOUT_SESSION_ID}',
    cancel_url: 'https://site.com'
  });

  return res.status(200).json(session);
};
```

```js
const stripe = require('stripe')(process.env.STRIPE_API_KEY);

exports.handler = async (event, context, callback) => {
  const session = await stripe.checkout.sessions.create({
    payment_method_types: ['card'],
    line_items: [
      {
        name: 'Serverless Functions – The Complete Guide',
        description: '100 page e-book on serverless functions.',
        images: ['https://site.com/image.png'],
        amount: '5000', // Cents
        currency: 'usd',
        quantity: 1
      }
    ],
    success_url: 'https://site.com/success?session_id={CHECKOUT_SESSION_ID}',
    cancel_url: 'https://site.com'
  });

  return {
    statusCode: 200,
    body: JSON.stringify(session)
  };
};
```

## Usage

<Step number={1} title="Create Stripe Account" />

First, [create a Stripe account](https://stripe.com/). Then, generate an [API key](https://mailchimp.com/help/about-api-keys/#find+or+generate+your+api+key).

<Step number={2} title="Find Audience ID" />

Each Mailchimp audience has a unique [Audience ID](https://mailchimp.com/help/find-audience-id/).
Retrieve the ID for the list you want to add a subscriber to.

<Step number={3} title="Add Environment Variables" />

To securely access the API, we need to include the secret with each request.
We also _do not_ want to commit secrets to git. Thus, we should use an environment variable.

- **Netlify:** Settings -> Build & deploy -> Environment -> Environment variables.
- **Vercel:** Settings -> General -> Environment Variables.

Alternatively, you can add the enviornment variable to your `vercel.json` or `netlify.toml` file.
